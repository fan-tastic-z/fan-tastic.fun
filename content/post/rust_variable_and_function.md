---
title: "Rust笔记----变量和函数"
date: 2023-07-23T15:23:39+08:00
tags: ["Rust"]
categories: ["Rust"]
draft: false
---

Rust的语法中分为:语句和表达式.
表达式主要用于计算求值.

语句分为:

- 声明语句:如声名变量,函数,结构体等.
- 表达式语句:特指以分号`;`结尾的表达式,即返回单元类型`()`

Rust编译器在解析代码时,碰到分号`;` 就会继续往后执行,如果碰到语句,则执行语句,碰到表达式,则会对表达式求值,如果分号`;`后什么都没有,则会补上单元值`()`.
当遇到函数时,将函数整体的花括号识别为表达式.块表达式是由一对花括号和一系列表达式组成的,它总是返回块中最后一个表达式的值.

通过如下代码进行理解:

```rust
fn say_hello() {
    1 + 1;  // 这里编译器就在后面帮我们加了`()`单元值
}

fn main() {
    let x = 10;
    // 块表达式是由一对花括号和一系列表达式组成的,它总是返回块中最后一个表达式的值.
    let result = if x > 5 { "及格" } else { "不及格" };
    println!("{}", result);
}
```

所以可以说,rust中一切皆表达式,或者rust是基于表达式的语言.

## 变量声明

`let x = 18;` 这个过程在其他语言中通常叫做 **赋值** 不过在Rust中叫作 **绑定** 更准确。即上述的过程在Rust中我们叫作： `变量绑定`。

任何内存对象都是有所属者的，当执行 `let x = "18";`的时候，就是告诉你在栈上的存的这个`18` 所属者是 `x`。

在Rust中，变量默认是不可变的，如果要创建一个可变变量,需要在声明变量时加上`mut`表示该变量是可修改的： `let mut x = 18;`。

Rust中对于没有使用的变量在编译的时候会告警，如果不想要告警可以 使用下划线作为变量名的开头`let _name = "fan-tastic"`。

Rust 允许重复声明变量，后声明的变量将遮盖（shadow）前面已经声明的变量。

```rust
fn main() {
    let name = "fan-tasitc";
    println!("{}", name);
    let name = "fan";
    println!("{}",name)
}
```

### 不可变变量 和 常量

常量绑定到一个常量名之后也是不允许更改的，但是和不可变变量还是有差异的：

- 常量不允许使用`mut`.
- 常量使用 `const`关键字而不是 `let`关键字来声明.
- 常量值的类型必须标注，不能省略.

## 函数

Rust中使用`fn`关键字定义函数.如果没有返回值,函数默认返回单元值`()`

```rust
fn say_hello() {
    println!("hello world!")
}
fn main() {
    let result = say_hello();
    println!("{:?}", result); //打印()
}
```

`say _hello()` 方法返回的就是单元值.

rust中有两种方式指定函数的返回值:
使用return 来制定返回值,此时return后要加上分号`;`,如果return 不指定返回值,同样是返回单元值`()`.
不使用return,将表达式的计算结果返回,此时表达式不能带分号`;`

```rust
fn is_available(a: i32) -> bool {
    if a > 10 {
        a>10   // 不使用return
    } else {
        return false; // 使用return
    }
}

fn main() {
    let result = is_available(100);
    println!("{}", result);
}
```
